/*!
 * Mapi - An easy to use wrapper for Google Maps API
 * Version: 1.0.0
 * Author: Thiago Ribeiro - thiagofribeiro@gmail.com
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("underscore"),require("jquery")):"function"==typeof define&&define.amd?define(["underscore","jquery"],t):"object"==typeof exports?exports.Mapi=t(require("underscore"),require("jquery")):e.Mapi=t(e._,e.jQuery)}(this,function(e,t){return function(e){function t(n){if(o[n])return o[n].exports;var a=o[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function n(e,t){var o={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n]);return o}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},s=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(2),p=o(1),c=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],o=t.height,s=void 0===o?"400px":o,c=t.lat,l=void 0===c?0:c,u=t.lng,m=void 0===u?0:u,d=t.zoom,g=void 0===d?2:d,h=n(t,["height","lat","lng","zoom"]),f=arguments.length<=1||void 0===arguments[1]?p.noop:arguments[1];if(a(this,e),h=i({height:s,lat:l,lng:m,zoom:g},h),this.objects={},e.prototype.instances[h.element]){var y=e.prototype.instances[h.element];y.reset(),r(h.element).append(y.map.getDiv()),y.create(h,f)}else e.prototype.instances[h.element]=this.create(h,f);return e.prototype.instances[h.element]}return s(e,[{key:"create",value:function(t,o){var n=this;return google?(this.geocoder=new google.maps.Geocoder,t.center=new google.maps.LatLng(t.lat,t.lng),this.mapCenter=t.center,p.each(t.themes,function(e){t.mapTypeControlOptions=t.mapTypeControlOptions||[],t.mapTypeControlOptions.mapTypeIds=t.mapTypeControlOptions.mapTypeIds||[],p.contains(p.keys(google.maps.MapTypeId),e.toUpperCase())&&(e=google.maps.MapTypeId[e.toUpperCase()]),p.contains(t.mapTypeControlOptions.mapTypeIds,e)||t.mapTypeControlOptions.mapTypeIds.push(e)}),this.map?this.map.setOptions(t):this.map=new google.maps.Map(r(t.element)[0],t),r(t.element).css("height",t.height),p.each(t.themes,function(t){n.map.mapTypes.set(t,new google.maps.StyledMapType(e.prototype.themes[t],{name:t}))}),t.defaultTheme&&this.setTheme(t.defaultTheme),this.map.setCenter(this.mapCenter),google.maps.event.trigger(this.map,"resize"),o()):console.error("Google Maps is not yet available"),this}},{key:"addMarker",value:function(e){var t=e.groupId,o=void 0===t?"markers":t,a=e.id,i=void 0===a?p.uniqueId("marker-"):a,s=e.lat,r=e.lng,c=n(e,["groupId","id","lat","lng"]);if(!this.existsObject(o,i)){c.position=new google.maps.LatLng(s,r),c.map=this.map,c.iconCenter&&(c.icon={url:c.icon,anchor:new google.maps.Point(c.iconCenter[0],c.iconCenter[1])}),c.animation&&(c.animation=google.maps.Animation[c.animation]);var l=new google.maps.Marker(c);return l.id=i,l.setMap(this.map),this.addObject(o,i,l),p.each(c.events,function(e,t){google.maps.event.addListener(l,t,function(t){e(t,l,i)})}),l}}},{key:"addCircle",value:function(e){var t=e.groupId,o=void 0===t?"circle":t,a=e.id,i=void 0===a?p.uniqueId("circle-"):a,s=e.lat,r=e.lng,c=n(e,["groupId","id","lat","lng"]);if(!this.existsObject(o,i)){c.center={lat:s,lng:r},c.map=this.map,c.iconCenter&&(c.icon={url:c.icon,anchor:new google.maps.Point(c.iconCenter[0],c.iconCenter[1])}),c.animation&&(c.animation=google.maps.Animation[c.animation]);var l=new google.maps.Circle(c);return l.id=i,l.setMap(this.map),this.addObject(o,i,l),l}}},{key:"addObject",value:function(e,t,o){this.objects[e]||(this.objects[e]={}),this.objects[e][t]=o}},{key:"existsObject",value:function(e,t){return"undefined"!=typeof this.objects[e]&&"undefined"!=typeof this.objects[e][t]?!0:!1}},{key:"reset",value:function(){p.each(this.objects,function(e,t){p.each(e,function(e,o){e.setMap&&e.setMap(null),e.remove&&e.remove(),e=null,delete this.objects[t][o]}.bind(this)),delete this.objects[t]}.bind(this))}},{key:"setTheme",value:function(e){p.contains(p.keys(google.maps.MapTypeId),e.toUpperCase())&&(e=google.maps.MapTypeId[e.toUpperCase()]),this.map.setMapTypeId(e)}},{key:"addControl",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?"TOP_LEFT":arguments[1],o=r(e);return o.attr("id",o.attr("id")||p.uniqueId("control-")),"undefined"==typeof this.objects.controls&&(this.objects.controls={}),"undefined"==typeof this.objects.controls[o.attr("id")]?(o.addClass("mapControl")[0],this.map.controls[google.maps.ControlPosition[t]].push(o[0]),o.data("position",t),this.objects.controls[o.attr("id")]=o,o):this.objects.controls[o.attr("id")]}},{key:"toggleVisibility",value:function(e,t){var o=this;t?this.objects[e][t]&&o.objects[e][t].setMap(o.objects[e][t].map==o.map?null:o.map):p.each(this.objects[e],function(e){e.setMap(e.map==o.map?null:o.map)})}}],[{key:"addTheme",value:function(t,o){e.prototype.themes=e.prototype.themes||{},e.prototype.themes[t]=o}},{key:"registerPlugin",value:function(e){var t=this;p.each(e,function(e,o){t.prototype[o]=e})}}]),e}();c.prototype.instances=c.prototype.instances||{},e.exports=c},function(t,o){t.exports=e},function(e,o){e.exports=t}])});